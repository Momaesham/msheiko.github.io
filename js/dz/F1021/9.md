# Теория

## Json

`JSON` (JavaScript Object Notation) - стандартный текстовый формат для представления структурированных данных на основе синтаксиса объекта JavaScript. Он обычно используется для передачи данных в веб-приложениях (например, отправка некоторых данных с сервера клиенту,таким образом чтобы это могло отображаться на веб-странице или наоборот).

JSON - текстовый формат данных, следующий за синтаксисом объекта JavaScript, который был популяризирован Дугласом Крокфордом. Несмотря на то, что он очень похож на буквенный синтаксис объекта JavaScript, его можно использовать независимо от JavaScript, и многие среды программирования имеют возможность читать (анализировать) и генерировать JSON.

JSON поддерживает следующие типы данных:

- Объекты { ... }
- Массивы [ ... ]
- Примитивы:
    - строки,
    - числа,
    - логические значения `true`/`false`,
    - `null`
```json
{
   "firstName": "Иван",
   "lastName": "Иванов",
   "address": {
       "streetAddress": "Московское ш., 101, кв.101",
       "city": "Ленинград",
       "postalCode": 101101
   },
   "phoneNumbers": [
       "812 123-1234",
       "916 123-4567"
   ]
}
```

JavaScript предоставляет методы:

- `JSON.stringify` для преобразования объектов в JSON.
- `JSON.parse` для преобразования JSON обратно в объект.

---

## Преобразование JS объекта в строку

Метод `JSON.stringify()` преобразует значение JavaScript в строку JSON, возможно с заменой значений, если указана функция замены(пока что нам это совсенм не нужно), или с включением только определённых свойств, если указан массив замены(это тоже не нужно).

`JSON.stringify(value[, replacer[, space]])`

`value`

    Значение, преобразуемое в строку JSON.

`replacer` Необязательный (ПОКА НЕ НУЖНО)

    Если является функцией, преобразует значения и свойства по ходу их преобразования в строку; если является массивом, определяет набор свойств, включаемых в объект в окончательной строке.

`space` Необязательный (ПОКА НЕ НУЖНО)

    Делает результат красиво отформатированным (расставляя пробелы).

Возвращает `строку`, соответствующий переданному объекту `value`.

---

Метод `JSON.stringify(student)` берёт объект и преобразует его в строку.

```javascript
let student = {
  name: 'John',
  age: 30,
  isAdmin: false,
  courses: ['html', 'css', 'js'],
  wife: null,
  print(){
      console.log('Hello');
  }
};

let json = JSON.stringify(student);

console.log(typeof json); // мы получили строку!

console.log(json);
/* выведет объект в формате JSON:
{
  "name": "John",
  "age": 30,
  "isAdmin": false,
  "courses": ["html", "css", "js"],
  "wife": null
}
*/
```

JSON является независимой от языка спецификацией для данных, поэтому JSON.stringify пропускает некоторые специфические свойства объектов JavaScript.

А именно:
- Свойства-функции (методы).
- Символьные свойства.
- Свойства, содержащие `undefined`.


Обратите внимание, что объект в формате JSON имеет несколько важных отличий от объектного литерала:

- Строки используют двойные кавычки. Никаких одинарных кавычек или обратных кавычек в JSON. Так `'John'` становится `"John"`.
- Имена свойств объекта также заключаются в двойные кавычки. Это обязательно. Так `age:30` становится `"age":30`.

---

## Преобразование строки в JS объект

Чтобы декодировать JSON-строку, нам нужен другой метод с именем `JSON.parse`.

`JSON.parse(text[, reviver])`

`text`

    Разбираемая строка JSON. Смотрите документацию по объекту JSON для описания синтаксиса JSON.

`reviver` Необязательный (ПОКА НЕ НУЖНО)

    Если параметр является функцией, определяет преобразование полученного в процессе разбора значения, прежде, чем оно будет возвращено вызывающей стороне.

Возвращает объект `Object`, соответствующий переданной строке JSON `text`.

```javascript
let user = '{ "name": "John", "age": 35, "isAdmin": false, "friends": [0,1,2,3] }';

user = JSON.parse(user); // получим JS объект user на основе JSON строки

console.log( user.friends[1] ); // обратимся к свойству объекта, т.к. это массив по индексу получим элемент => 1
```

---

# XMLHttpRequest

`XMLHttpRequest` – это встроенный в браузер объект, который даёт возможность делать запросы к серверу.

На сегодняшний день не обязательно использовать `XMLHttpRequest`, так как существует другой, более современный метод `fetch`.

    Нам не нужно разбираться как работает XMLHttpRequest, мы будем использовать его исключительно для работы с объектами, получаемыми в формате JSON от сервера.

Чтобы сделать запрос, нам нужно выполнить четыре шага:

- Создать XMLHttpRequest.

    ```javascript
    let xhr = new XMLHttpRequest(); // у конструктора нет аргументов
    ```

- Инициализировать его.


    ```javascript
    xhr.open('GET', 'Адрес сервара куда отправляется запрос');
    ```

    Заметим, что вызов `open`, вопреки своему названию, не открывает соединение. Он лишь конфигурирует запрос, но непосредственно отсылается запрос только лишь после вызова `send`.

- Послать запрос.

    ```javascript
    xhr.send([body])
    ```
    Этот метод устанавливает соединение и отсылает запрос к серверу. Необязательный параметр body содержит тело запроса.

- Ждать ответ.

    ```javascript
    xhr.onload = function() { // происходит когда выполнен любой запрос
    alert(`Загружено: ${xhr.status} ${xhr.response}`);
    };

    xhr.onerror = function() { // происходит, только когда запрос совсем не получилось выполнить
    alert(`Ошибка соединения`);
    };
    ```
    Три наиболее используемых метода:
    - `onload` – происходит, когда получен какой-либо ответ, включая ответы с ошибкой, например 404.
    - `onerror` – когда запрос не может быть выполнен, например, нет соединения или неправильный адрес запроса


---

## Пример

```javascript
// 1. Создаём новый XMLHttpRequest-объект
let xhr = new XMLHttpRequest();

// 2. Настраиваем его
xhr.open('GET', 'Адрес сервера'); // Меняем `Адрес сервера` на свой

// 3. Отсылаем запрос
xhr.send();

// 4. Этот код сработает после того, как мы получим ответ сервера
xhr.onload = function() {
    console.log('Onload');
    const result = xhr.response; //  Получаем ответ, это JSON строка
    const object = JSON.parse(result); // Преобразуем строку в JS объект
    // Пишем код домашки ТУТ!!!
    console.log(object);  // Выводим результат по необходимости
};

// Этот код сработает если мы не получим ответ от сервера
xhr.onerror = function() {
  console.error("Запрос не удался");
};
```

# Практика

## Задача 1

Получите по адресу [https://jsonplaceholder.typicode.com/users](https://jsonplaceholder.typicode.com/users) массив объектов
- Преобразуйте их в массив объектов вида
    ```javascript
    [
        {
            id: 1, // соответсвующий id из JSON
            name: 'FIRSTNAME', //Возьмите только имя (часть строки до первого пробела), сделайте все буквы заглавными
            phone: 'номер телефона', // Удалите все кроме цифр
            location: {
                street: 'Улица',
                index: 'Почтовый индекс',
                number: 'Номер suite' // Оставьте только цифры ("suite": "Apt. 950" => number: 950 (число))
            }
        },
        ....
    ]
    ```
- Полученный массив преобразуйте заменив `phone` на сумму ТОЛЬКО четных цифр из этого же свойства
- Отсортируйте массив по `name`
- Удалите из массив всех в номере дома которых есть цифра 1
- Разделите индекс всех на 2 и округлите результат до целого вверх
- Выведите результат

---

## Задача 2

Получите по адресу [https://jsonplaceholder.typicode.com/posts](https://jsonplaceholder.typicode.com/posts) массив объектов

- Удалите из массив все элементы `title` который больше 25 символов
- Каждуй первую букву слова из свойства `body` сделайте заглавной
- Отсортируйте массив по длине `body`
- Удалите из всех элементов свойство `userId`
- Выведите результат
- Преобразуйте результат в JSON строку и вывидите
